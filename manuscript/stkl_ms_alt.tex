% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Preliminaries
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

\documentclass[11pt]{article}
\usepackage[letterpaper, margin=1in]{geometry}
\usepackage{newtxtext,newtxmath}
\usepackage[math-style=ISO]{unicode-math}
\usepackage{fullpage}
\usepackage[authoryear,sectionbib]{natbib}
\linespread{1.7}
\usepackage[utf8]{inputenc}
\usepackage{lineno}
\usepackage{titlesec}
\titleformat{\section}[block]{\Large\bfseries\filcenter}{\thesection}{1em}{}
\titleformat{\subsection}[block]{\Large\itshape\filcenter}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[block]{\large\itshape}{\thesubsubsection}{1em}{}
\titleformat{\paragraph}[runin]{\itshape}{\theparagraph}{1em}{}[. ]\renewcommand{\refname}
  {Literature Cited}
\DeclareTextSymbolDefault{\dh}{T1} % for Icelandic ð symbol:
\usepackage{graphicx} % for figures
\usepackage{booktabs} % for tables
\usepackage{amsmath} % for split math environment
\usepackage{enumitem}




% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Title page
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------


\title{Transient dynamics of spatially structured fluctuations 
        in a threespine stickleback metapopulation}

\author{
Joseph S. Phillips$^{1,2, \dagger}$ \\
\'{A}rni Einarsson$^{3,4}$ \\ 
Kasha Strickland$^{1}$ \\
Anthony R. Ives$^{2}$ \\
Bjarni K. Kristj\'{a}nsson$^{1}$ \\
Katja R\"{a}s\"{a}nen$^{5,6}$ 
}

\date{}

\begin{document}

\raggedright
\setlength\parindent{0.25in}

\maketitle


\noindent{} 1. Department of Aquaculture and Fish Biology, 
H\'{o}lar University, Sau{\dh}\'{a}rkr\'{o}kur 551 Iceland

\noindent{} 2. Department of Integrative Biology, 
University of Wisconsin, Madison, Wisconsin 53706 USA

\noindent{} 3. M\'{y}vatn Research Station, IS-660 M\'{y}vatn, Iceland

\noindent{} 4. Faculty of Life and Environmental Sciences, 
              University of Iceland, 101 Reykjav\'{i}k, Iceland

\noindent{} 5. Department of Aquatic Ecology, EAWAG and 
Institute of Integrative Biology, ETH Zurich, 
\"{U}berlandstrasse 133, CH-8600 D\"{u}bendorf, Switzerland

\noindent{} 6. Department of Biological and Environmental Sciences, 
University of Jyv\"{a}skyl\"{a}, 40014, Jyv\"{a}skyl\"{a}, Finland

\noindent{} $\dagger$ E-mail: joseph@holar.is



\bigskip

Running head: {Metapopulation fluctuations}

\linenumbers{}

\clearpage





% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Abstract
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

\section*{Abstract} \label{abstract}

Uncovering the demographic basis of population fluctuations is challenging 
for spatially structured populations, 
because this requires disentangling synchrony in demographic rates 
from coupling via dispersal. 
In this study, we fit a stage-structured metapopulation model to a 29-year times series 
of threespine stickleback abundance in the heterogeneous 
and productive Lake M\'{y}vatn, Iceland. 
The lake comprises two basins (North and South) connected by a channel, 
through which the stickleback disperse. 
The model includes time-varying demographic rates, 
allowing us to disentangle the contributions of recruitment and survival, 
spatial coupling via dispersal, and transient dynamics 
to the population’s large fluctuations in abundance. 
Our analyses indicate that recruitment was only modestly synchronized between the two basins, 
whereas survival probabilities of adults were more strongly synchronized, 
contributing to cyclic fluctuations in the lake-wide population size 
with a period of approximately 6 years. 
The analyses further show that the two basins are coupled through dispersal, 
with the North basin subsidizing the South basin and playing a dominant role 
in driving the lake-wide dynamics. 
Moreover, transience due to non-equilibrium distributions of individuals 
across basins and stage classes results in large short-term changes in abundance 
that partially obscure the cyclic nature of the dynamics. 
Our results show that cyclic fluctuations can arise through both spatial coupling 
and synchronization of demographic rates, and they highlight the importance 
of accounting for transience in analyses of population dynamics.


\bigskip

\textit{Keywords}: {demography, \textit{Gasterosteus aculeatus}, metapopulation,
                    M\'{y}vatn, population cycles, state-space model}

\clearpage



% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Introduction
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

\section*{Introduction} \label{introduction}

Temporal fluctuations in demographic processes such as survival and reproduction
are of central importance to population biology
\citep{twombly1994,fox2000population,koons2016life}.
Changes in demographic rates underpin population fluctuations arising from both 
endogenous processes such as predator-prey interactions 
\citep{rosenzweig1963}
and exogenous processes such as climatic variability
\citep{elton1924}.
Furthermore, demographic rates can change in response to trait plasticity and evolution
\citep{ellner2011does, bonnet2019role},
and the interplay between ecological and evolutionary dynamics in wild populations 
is often predicated on the potential for demographic rates to vary through time
\citep{ellner2011does, coulson2006putting, siepielski2009s, ozgul2010coupled}.
While temporal variation in demographic rates has been extensively studied,
these studies are generally restricted to populations subject to long-term monitoring
with repeated observations of uniquely identified individuals 
\citep[e.g., mark-recapture;][]{fujiwara2002}.
Given the expense and logistical challenges of such studies, 
they are unlikely to be representative of the range of dynamics found in wild populations.
Furthermore, long-term demographic studies often focus on directional trends
or responses to specific drivers 
\citep[e.g., ][]{hunter2010climate, diller2016demographic}
rather than addressing 
population fluctuations per se \citep[but see][]
{white2007irruptive, koons2017understanding, taylor2018demographic, hoy2020fluctuations}.
Consequently, 
there is a need for further studies characterizing the demographic underpinnings 
of population fluctuations 
\citep{coulson2005decomposing}, 
especially in systems that are generally underrepresented 
in long-term demographic studies.

Uncovering the demographic basis of population fluctuations can be particularly challenging
for metapopulations
\citep{bjornstad1999spatial}, 
whereby discrete patches or sub-populations are linked through dispersal
\citep{hanski1998}.
Synchronous fluctuations in patch-level abundance will tend to reinforce each other 
in the metapopulation dynamics,
while asynchronous or compensatory fluctuations will tend to cancel each other out
\citep{liebhold2004spatial}. 
The degree of synchrony between the patch-level dynamics will be influenced
by the extent to which the within-patch demographic rates 
(e.g., reproduction and survival) are synchronized between patches
\citep{ranta1995synchrony, liebhold2004spatial}.
Synchronization could arise from synchronous changes in environmental
drivers such as climate 
\citep{moran1953}
or through patches being indirectly coupled by joint interactions with another 
dynamic agent such as a mobile predator
\citep{ims2000, gilg2009}. 
Moreover, direct coupling between patches via dispersal can alter the patch-level dynamics
\citep{liebhold2004spatial},
and the effect of dispersal on the metapopulation dynamics interacts 
with processes occurring within patches 
\citep{ranta1995synchrony, kendall2000dispersal, goldwyn2008}.
Disentangling the effects of direct coupling through dispersal, 
the degree of synchrony between demographic processes within patches, 
and the interplay between the two 
is an important step in characterizing metapopulation fluctuations
\citep{liebhold2004spatial, abbott2011}.

Further complicating efforts to characterize the demographic basis 
of population fluctuations is the potential role of transience.
``Transience'' refers to short-term dynamics of a system 
that differ from the long-term or asymptotic dynamics under a fixed set of conditions
\citep{hastings2010}.
In the case of demographically-structured populations,
a fixed set of demographic rates implies an equilibrium distribution
of individuals across population states such as stage-classes or patches
\citep{caswell2001matrix}.
The population's state distribution will tend towards its equilibrium,
and this will generally entail transient changes 
in the total population growth rate.
The qualitative behavior of transience depends
on the exact configuration of demographic rates
but can include cyclic fluctuations 
as the population approaches its equilibrium distribution
\citep{caswell2001matrix}.
By definition, these transient fluctuations occur in the absence 
of temporal variation in the underlying demographic rates.
When demographic rates vary through time,
which is true to at least some extent for all wild populations,
the equilibrium distribution will be a ``moving target''
such that a given population is likely to be in a perpetual state of disequilibrium
\citep{fox2000population, koons2017understanding}.
Whether such perpetual disequilibrium results in large transience 
depends on the extent to which the underlying demographic rates change through time
and the rate at which the population approaches its ever-changing equilibrium distribution,
which is itself a function of the time-specific demographic rates
\citep{caswell2005reactivity, caswell2007sensitivity}.
Despite the growing recognition
\citep{caswell2007sensitivity, koons2017understanding},
the contribution of transience to fluctuations in wild populations is generally unknown
\citep[but see][]{hoy2020fluctuations}.

In this study, 
we analyzed the metapopulation fluctuations of threespine stickleback 
(\textit{Gasterosteus aculeatus})
over the course of three decades in Lake M\'{y}vatn, Iceland.
The M\'{y}vatn stickleback population is spatially structured by the unique geomorphology
of the lake \citep{gislason1998, millet2013}, 
which is divided into two basins connected by two narrow channels 
(Figure \ref{fig:data}a).
The larger South Basin (Sy{\dh}rifl\'{o}i; $28~\text{km}^2$)  
is dominated by exposed sediment and intermittent mats of filamentous green algae
\citep{einarsson2004myvatn}.
The substantially smaller North Basin (Ytrifl\'{o}i; $8.5~\text{km}^2$) 
is more spatially heterogeneous, 
in part due to dredging of the lake bottom
that substantially altered its bathymetry.
The North Basin has historically sustained much higher
densities of threespine stickleback  \citep{gislason1998}, 
presumably due to the ecological differences between the basins. 
Despite the narrow connection between the basins, 
population genetic \citep{millet2013} 
analyses indicate limited differentiation,
which implies extensive gene flow and admixture.
This is consistent with previous studies indicating that lacustrine populations
of threespine sticklebacks have the potential to be  
well-mixed through extensive within-lake dispersal
\citep{bolnick2009phenotype},
although there are also several examples of small-scale population divergence
within lakes [REFERENCES].

Furthermore, the M\'{y}vatn stickleback population fluctuates substantially through time.
While the causes of these fluctuations are unknown, 
they are likely connected to the large temporal variability 
of other species in the lake.
M\'{y}vatn is naturally eutrophic due to the inflows of nutrient-rich springs,
which sets the stage for high-amplitude fluctuations in secondary producers
\citep{einarsson2004myvatn}.
Chief among these are various species of rotifers, chironomids, and crustaceans
\citep{einarsson2002, einarsson2004clad, gardarsson2004population, ives2008},
some of which are important food sources for threespine stickleback
\citep{gudmundsson1996}.
Moreover, the lake hosts temporally-variable populations 
of Arctic charr (\textit{Salvelinus alpinus}), 
brown trout (\textit{Salmo trutta}), 
and piscivorous birds that have the potential 
to induce fluctuations in the stickleback population from the top down
\citep{gardarsson1979waterfowl, gudbergsson2004}.
Finally, M\'{y}vatn's stickleback can sustain high loads of the tapeworm
\textit{Schistocephalus solidus} \citep{gislason1998, karvonen2013},
which substantially reduces fecundity in other threespine stickleback populations 
\citep{heins2010evolutionary, heins2012fecundity}.

To characterize the spatiotemporal dynamics of the M\'{y}vatn stickleback population, 
we fit a stage-structured metapopulation model \citep{caswell2001matrix}
to a 29-year times series of stickleback abundance.
The model included temporal variation in basin-level recruitment and survival, 
and dispersal between basins,
with changes in these demographic rates being statistically inferred 
as required to account for the observed population dynamics.
This approach provides great flexibility in modeling the demographic underpinnings of 
population dynamics,
including those implicitly arising from exogenous and endogenous processes
\citep{zeng1998, ives2012}.
Equipped with the parameterized model, 
we quantified the covariance in recruitment and survival between the two basins
in addition to the degree of coupling through dispersal.
Furthermore, we quantified both the direct and transient effects of 
time-varying recruitment, survival, and dispersal
on the metapopulation dynamics.
Our analysis illustrates how spatially structured fluctuations  
can arise through the conjunction of spatial synchrony in demographic rates
and spatial coupling through dispersal in a wild population. 




% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Methods
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\section*{Methods} 
% ---------------------------------------------------------------------------------------



% ---------------------------------------------------------------------------------------
\subsection*{Long-term data collection} 
% ---------------------------------------------------------------------------------------

From 1991 to 2020, 
the stickleback population of M\'{y}vatn was surveyed in June and August of each year
(hereafter ``June census'' and ``August census'', respectively). 
The surveys were conducted at eight off-shore sites, 
five in the South Basin and three in the North Basin
(Figure \ref{fig:data}a).
These sites provided wide coverage of the lake,
with exception of the eastern portion of the South Basin 
which historically has had negligible densities of sticklebacks.
For each site and survey event, 
we set un-baited minnow traps for two 12-hour sessions, 
one during the day and one during the night. 
Typically, five traps were set and counted separately, 
although occasionally fewer traps were set or 
trap-catches were pooled for a given site prior to counting.
Trapped individuals were sorted into two size-classes (small and large)
with a threshold of 50mm in June and 45mm in July, based on \citep{gislason1998}. 
Although there is likely variation in size-at-maturation \citep{singkam2019},
these size classes are expected to correspond with sexual maturity 
\citep{gudmundsson1996, gislason1998},
and for the purposes of demographic modeling (described below) 
we interpreted them as two stage-classes: juvenile (small) and adult (large).
In general, threespine stickleback reach maturity at 1-2 years of age
\citep{baker2008overview},
although age and size at maturation are plastic triats \citep{baker2015life}
that may differ among populations \citep{snyder1991migration}.

We used site-level catch per unit effort (CPUE) for each of the two stage-classes 
at each time point to parameterize the metapopulation model described below. 
CPUE was calculated by summing across all traps set during both day and night sampling
and then dividing by the total number of traps.
Within each basin and stage class, 
site-level catches were of comparable magnitude and 
generally correlated through time (Figure \ref{fig:data}b).
Therefore, while we used site-level CPUE to parameterize the model, 
the model was formulated in terms of relative basin-level density,
with the sites serving as repeated observations of the same basin-level density estimate,
as described in more detail below.
Note that we grouped site 135 with the South Basin, 
as its stickleback catch was similar to other sites within the South Basin in most years.
However, 
we acknowledge that an unusually large number of adults were trapped at site 135
in 2019 and 2020, which may not be fully captured in our basin-level analysis.




% ---------------------------------------------------------------------------------------
\subsection*{Metapopulation model} 
% ---------------------------------------------------------------------------------------

We used a stage-structured metapopulation model \citep{caswell2001matrix}
with time-varying demographic rates
to characterize the dynamics of the stickleback population. 
The model projected the population dynamics due to 
recruitment, survival, and transitions 
from juvenile to adult (``stage transitions'') within each basin,
as well as dispersal between basins (see below for details). 
Recruitment, survival, and dispersal were allowed to vary through time,
enabling the model to characterize a range of dynamics, 
including those implicitly due to endogenous (e.g., density dependence) 
and exogenous (e.g., environmental variation) processes
\citep{zeng1998, ives2012}. 
We estimated the demographic rates by  
fitting the model to the time series of CPUE,
as described in detail below. 
In general terms, this approach works by reconstructing the demographic rates required
to project the distribution of abundances across demographic states 
from one time step to the next. 
By explicitly modeling temporal variation in the demographic rates,
we were able to take advantage of shared information across all time points simultaneously 
to successfully constrain the parameter estimates.

For a given time interval from $t-1$ to $t$,
the population dynamics were projected as
%
% \begin{equation} \label{eq:XPX}
%     \mathbf{x}_t = \mathbf{P}_{t-1}~\mathbf{x}_{t-1}
% \end{equation}
% %
% where $\mathbf{P}_{t}$ is 4 $\times$ 4 a matrix of demographic rates at time $t$,
% and $\mathbf{x}_{t}$ is a 4 $\times$ 1 vector of relative abundances
% for a given stage (juveniles $j$; adults $a$)
% and basin (south $s$; north $n$):
% %
% \begin{equation} \label{eq:X}
% \mathbf{x}_{t} =
% \left[
% \begin{array}{cccc}
%     {x_{j,s,t}} \\
%     {x_{a,s,t}} \\
%     {x_{j,n,t}} \\
%     {x_{a,n,t}}
%     \end{array}
% \right]
% \text{.}
% \end{equation}
% %
% The projection matrix $\mathbf{P}_{t}$ can be expressed as
% %
% \begin{equation} \label{eq:P}
% \mathbf{P}_{t} =
% \left[
% \begin{array}{c|ccc}
%     \mathbf{W}_{s,t}  & \mathbf{B}_{s\rightarrow n,t} \\
%     \hline
%     \mathbf{B}_{n\rightarrow s,t} & \mathbf{W}_{n,t}
%     \end{array}
% \right]
% \end{equation}
%
where $\mathbf{W}_{i,t}$ is a 2 $\times$ 2 matrix characterizing
per capita contributions within basin $i$,
and $\mathbf{B}_{i\rightarrow k,t}$ is a 2 $\times$ 2 matrix characterizing
contributions from basin $i$ to basin $k$.
Within-basin contributions were modeled as
 %
% \begin{equation} \label{eq:W}
% \mathbf{W}_{i,t} =
% \left[
% \begin{array}{cccc}
%     \phi_{j,i,t}~(1-\gamma_{j})~(1-\delta_{j,i,t}) &
%     \rho_{i,t} \\
%     \phi_{j,i,t}~\gamma_{j}~(1-\delta_{a,i,t}) &
%     \phi_{a,i,t}~(1-\delta_{a,i,t})
%     \end{array}
% \right]
% \end{equation}
%
where $\phi_{h,i,t}$ is the survival probability of stage-class $h$,
$\gamma_{j}$ is the proportion of surviving juveniles that transition into adults
(i.e., the ``stage-transition'' probability),
$\delta_{h,i,t}$ is the proportion of surviving individuals that disperse to the other basin,
and $\rho_{i,t}$ is per capita recruitment.
We modeled between-basin contributions as
%
% \begin{equation} \label{eq:B}
% \mathbf{B}_{i,t} =
% \left[
% \begin{array}{cccc}
%     \phi_{j,i,t}~(1 - \gamma_{j})~\delta_{j,i,t} &
%     0 \\
%
%     \phi_{j,i,t}~\gamma_{j}~\delta_{a,i,t} &
%     \phi_{a,i,t}~\delta_{a,i,t}
%     \end{array}
% \right].
% \end{equation}
%
For computational tractability,
we fixed the stage-transition probability $\gamma_{j}$ to a single value
for both basins and through time;
therefore, temporal variation in stage-transitions was implicitly incorporated
into the time-varying survival probabilities.

To be biologically interpretable,
survival, dispersal, and stage-transition probabilities must be constrained to between
0 and 1.
Furthermore,
probabilities of all possible fates for an individual beginning in a given state
(i.e., basin $\times$ stage combination) must sum to 1.
To accommodate these constraints,
we modeled survival, dispersal, and stage-transitions
in terms of latent transition rate matrices,
from which we calculated the transition probabilities
(i.e., $\phi_{h,i,t}$, $\gamma_{j}$, and $\delta_{h,i,t}$)
projected over the interval between time steps (see Appendix I).
This approach imposes an inverse relationship between
the basin-specific dispersal probabilities for a give stage class,
which is appropriate because only the net dispersal between basins manifests
in the population dynamics.
Our formulation first calculates survival, then stage transitions, and finally dispersal
(equation \ref{eq:POmega}),
which is reflected in the structure of equations \ref{eq:W} and \ref{eq:B}.

We modeled temporal variation in recruitment and latent transition rates as
%
% \begin{equation} \label{eq:omega}
%     \omega^{\alpha}_t & \sim \text{Gaussian}
%         \left(
%             \omega^{\alpha}_{t-1},~\sigma_{\alpha}}
%         \right) \text{T}(0, \infty)
% \end{equation}
%
where $\alpha$ denotes the identity of the rate (e.g., South Basin recruitment),
and $\sigma_{\alpha}$ is the standard deviation.
This approach results in smooth changes in the demographic rates through time,
since the contribution of equation \ref{eq:omega} to the model likelihood (defined below)
declines as the difference between $\omega^{\alpha}_t$ and $\omega^{\alpha}_{t-1}$
increases;
the strength of this penalization for changes in $\omega^{\alpha}_t$
is inversely proportional to $\sigma_{\alpha}$.
We used a single value of $\sigma_{\alpha}$ for recruitment in both basins,
and a single value for survival and dispersal of all state combinations,
as these demographic processes respectively occurred on similar scales.
Furthermore, equation \ref{eq:omega} was truncated from the left at zero to ensure the
demographic rates remained positive.

We used a Bayesian approach to estimate the demographic parameters in the metapopulation model
(equations \ref{eq:XPX} through \ref{eq:omega}) by fitting the model to site-level
CPUE for each stage-class $h$ at each time step $t$,
with a function $m(k)$ defined to map site $k$ to basin $i$.
Because were interested in using CPUE to infer the relative abundance between basins,
(rather than the absolute magnitude of CPUE),
we divided CPUE by the overall mean CPUE for model fitting (hereafter ``scaled CPUE'').
Furthermore, the metapopulation model was formulated in terms of
relative populations sizes in each basin,
while site-level CPUE was interpreted as a measure
of average population density within each basin.
To account for this, we defined a variable $\kappa_i$ to represent the relative
sampling areas of the South Basin and the North Basin covered by the sampling sites,
which were originally selected to represent the full distribution
of the population throughout the lake.
Specifically, we defined $\kappa_s$ as the region of the South Basin excluding the region
east of the chain of islands and south of site 135 (c. $17.5~\text{km}^2$),
and $\kappa_n$ as the entire North Basin (c. $8.5~\text{km}^2$) (Figure \ref{fig:data}a).
This resulted in a 2:1 relative scaling of South vs. North Basin,
or $\kappa_s = 2$ and $\kappa_b = 1$.
Using these definitions, we calculated the likelihood of the scaled CPUE $y_{h,k,t}$
given a modeled relative abundance $x_{h,i,t}$ as
%
% \begin{equation} \label{eq:likelihood}
% \mathcal{L} =
% \displaystyle\prod_{h}
% \displaystyle\prod_{k}
% \displaystyle\prod_{t}
% \text{Gaussian}
%     \left(
%         y_{h,k,t}~|~x_{h,m(k),t} / \kappa_{m(k)},~\sigma_y
%     \right),
% \end{equation}
%
with standard deviation $\sigma_y$ representing ``sampling error''
that includes deviations of sites from the mean basin-level density.
For abundance data that are necessarily non-negative (such as CPUE),
it is common to model the likelihood using a distribution that is similarly constrained,
such as a log-normal distribution.
However, the multiplicative nature of population processes is already entailed
in the population projection,
and a log-normal likelihood reduces the relative contribution of large population sizes
that likely reflect meaningful dynamics.
Therefore, we opted for a Gaussian likelihood.
Because the model was parameterized in a way that ensured
$x_{h,i,t}$ was non-negative,
the posterior distribution of $x_{h,i,t}$ was also guaranteed to be non-negative.
We used gamma priors with shape parameter 1.5 and scale parameter 0.75
for the initial values for demographic rates,
and standard deviations for time-varying rates and model likelihood.
A gamma distribution with shape parameter of 1.5 has zero density at zero
and is concave down as it approaches its mode,
allowing the posterior to be arbitrarily close to zero
while not being artificially drawn towards it.
This shape parameter, along with scale parameter of 0.75,
implies a mean of 2,
which defines a reasonable scale for all of the parameters
following the scaling of the population estimates (see below).
We used an exponential prior with a rate of 0.5 for initial relative abundances,
which we choose as it was somewhat more diffuse than the gamma priors.

We fit the model using Stan 2.19 \citep{carpenter2017}
run from R 4.0.3 \citep{r2020}, with the \texttt{rstan} package \citep{Stan2018}.
We fit the model with 4 chains,
8000 iterations (4000 of warm-up and 4000 of sampling),
and set the ``adapt-delta'' parameter to 0.9.
Convergence was assessed by the number of divergent transitions
and the potential scale reduction factor (\^{R}),
which quantifies the relative variance within and between chains.
We used posterior medians as point estimates
and quantile-based uncertainty intervals
with coverage analogous to standard errors
(i.e., 16\% and 84\% quantiles for 68\% coverage).

In addition to the full model,
we also fit three reduced models to which it could be compared:
%
\begin{enumerate}[label=(\arabic*)]
\item
the ``adult dispersal" model omitted juvenile dispersal,
as the fit of the full model implied negligible net dispersal of juveniles between the basins;
%
\item
the ``no dispersal'' model omitted dispersal entirely,
allowing us to assess the contribution of dispersal to the model fit;
%
\item
the ``fixed rates'' model fixed recruitment, survival, and adult dispersal through time
(with juvenile dispersal omitted altogether),
allowing us to assess the contribution of temporal variation in demographic rates
to the model fit.
\end{enumerate}
%
We assessed goodness-of-fit using two metrics:
the posterior median of the log-likelihood given by equation \ref{eq:likelihood}
and the ``Leave-one-out Information Criterion'' or LOOIC,
which is analogous to the Akaike Information Criterion (AIC)
and can be interpreted in a similar manner.
We calculated LOOIC using the \texttt{loo} package \citep{vehtari2020}.




%========================================================================================

\subsection*{Annual dynamics and sensitivity analysis}

%========================================================================================

While we parameterized the model in terms of seasonal projections
to accommodate the seasonal nature of the data (i.e., June and August censuses),
we focused our analysis on the annual dynamics to better reflect
the annual nature of spawning in this population
and to circumvent interpretational
issues arising from the unequal projection intervals within a year.
Accordingly, we defined the annual projection matrix as
%
% \begin{equation} \label{eq:A}
% \mathbf{A}_y = \mathbf{P}_{t[y]+1} \mathbf{P}_{t[y]}
% \end{equation}
%
for year $y$ and sequential time steps within that year $t[y]$ and $t[y]+1$,
with the year defined to start with the June census.
$A_y$ projects the dynamics from
June of one year to June of the next year.
Because $P_t_y$ was defined through June of 2020,
we only calculated $A_y$ from 1991 through 2019.

We characterized the overall dynamics of the population in terms of the annual
population growth rate $\lambda_y$, calculated as
%
% \begin{equation} \label{eq:lam-n}
% \lambda_y = \frac{N_{y+1}}{N_y} =
%               \frac{\mathbf{c}^\top \mathbf{A}_y \mathbf{x}_y}
%                     {\mathbf{c}^\top \mathbf{x}_y}}
% \end{equation}
%
where $N_y$ is the summed abundance across basins and life stages in June of year $y$
and $c$ is a 4 $\times$ 1 vector of ones.
Temporal variation in $\lambda_y$ reflects both variation in the demographic rates
and transient fluctuations due to non-equilibrium state distributions.
Therefore, it is also informative to calculate
the asymptotic population growth rate that
would obtain under the equilibrium state distribution in a given time step,
which is equal to real part of the leading eigenvalue of $A_y$
\citep{caswell2001matrix}.

Both the transient and asymptotic population growth rates appeared to display periodic
behavior for at least a portion of the three-decade time series (see Results).
We quantified this putative periodicity by applying continuous wavelet transforms to
the time series for the transient and asymptotic growth rates,
on a log-scale (the results were similar for the raw values)
and with no detrending.
Wavelet transforms are a generalization of Fourier transforms,
allowing the decomposition of the signal into periodic elements to be localized in time.
As our use of wavelet transforms was chiefly descriptive and applied to signals
that were themselves the outputs of a statistical model,
we did not attempt to apply formal statistical inference (i.e., hypothesis testing)
to the wavelet decomposition.
We conducted the wavelet analysis using the R package \texttt{WaveletComp},
and for tractability we applied the wavelet transform
to the posterior median of $\lambda_y$ (rather than to multiple Markov chain samples).

We conducted a sensitivity analysis
to evaluate the effect of perturbations
in the demographic rates on the population growth rate,
using the approach of \cite{caswell2007sensitivity}
that is applicable to transient dynamics
(see Appendix II for relevant formulas).
The sensitivity of the population growth rate with respect to a demographic parameter
quantifies how much the growth rate would change in response to a perturbation in that
demographic parameter.
In order to compare across parameters of different values
(which is particularly relevant in the present context with time-varying rates),
it is common to calculate proportional change in
response to proportional perturbations,
otherwise known as ``elasticity''  \citep{caswell2001matrix}.
For each year, we calculated the elasticity of the annual growth rate with respect
to the demographic rates at each of the two time-steps within that year.
To simplify the presentation,
we added together the  elasticities for the two time-steps within a given year
for each demographic parameter.
We report the sensitivity analysis for both transient and asymptotic growth rates.
Transient sensitivity analysis propagates perturbations in the demographic rates
through time,
such that transience due to non-equilibrium state distributions is attributed to the
demographic parameters resulting in the non-equilibrium state distribution
for a given time step \citep{caswell2007sensitivity}.
Transient results were obtained by propagating each perturbation for
a single time-step for each year,
while approximate asymptotic results were obtained by propagating for 50 time-steps,
which we confirmed was sufficiently long to exclude transient effects
through visual comparison to shorter projections.
The sensitivity analysis was performed for 2000 samples of the Markov chain generated
during fitting of the full demographic model to propagate uncertainty parameter estimates.





% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Results
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\section*{Results}
% ---------------------------------------------------------------------------------------

The full and adult-dispersal models fit the data similarly well (Table \ref{tab:compare})
and provided visually indistinguishable estimates of
relative abundance (Figure \ref{fig:fit}).
This result was corroborated by the negligible net-dispersal
of juveniles inferred by the full model.
Negligible net-dispersal does not necessarily imply
that juveniles did not disperse between basins,
but rather that there was no clear signature of differential dispersal
in the population dynamics.
In contrast, the model omitting both juvenile and adult dispersal fit
the data more poorly than the models including adult dispersal.
The effect of removing adult dispersal on the abundance estimates was subtle
for North Basin juveniles and adults in both basins,
with the no-dispersal model showing slightly less flexibility in matching
relatively large fluctuations in the data than the models including adult dispersal.
However,
the effect of eliminating adult dispersal was more conspicuous for South Basin juveniles,
as the model without dispersal substantially overestimated abundance relative to the data
in several years.
This is because the abundance of South Basin juveniles in those time points was too low
to account for the subsequent abundance of South Basin adults
in the absence of subsidies from the North Basin.
Fixing the demographic rates through time resulted in a much worse fit to the data,
with the abundance estimates rapidly attaining an equilibrium state-distribution
and thereby failing the characterize variation in the data.
Together, these results indicated that temporal variation in the demographic rates,
including adult dispersal, were important in accounting
for the observed dynamics of the population.
However, dispersal of juveniles appeared to have a negligible effect on the dynamics.
Therefore, we present results from the adult-dispersal model hereafter.

The demographic rates fluctuated substantially over the study period,
resulting in large changes in abundance.
The overall magnitudes of per capita recruitment were similar between the two basins,
although South Basin recruitment was more variable (Figure \ref{fig:rec}a,b).
Covariance in recruitment between the two basins was low relative
to the respective variances,
although some major events (e.g., the sharp decline following a peak in 2015)
manifested in both basins.
Survival probabilities covaried substantially across stage classes within each basin
and also covaried between basins, particularly for adults (Figure \ref{fig:surv}a,b).
For both stage classes in both basins,
survival probabilities peaked in 2002-2003
prior to an extended decline until 2015,
after which survival probabilities generally increased.
However, survival probabilities of south basin juveniles were lower
than for the other classes throughout the time series,
and this was especially true during the final decade.
Figure \ref{fig:disp} shows the net number of individuals
that dispersed between basins (rather than basin-specific dispersal probabilities),
as this is most dynamically relevant
and thereby ``visible'' to the model when fit to the data.
Net dispersal was generally low and punctuated by several ``waves'' of movement from
north to south.
While these waves of southward dispersal persisted throughout the time series,
they were substantially larger prior to 2005 than afterwards.
The direction of net dispersal was rarely northward and only of substantial magnitude in 2004,
following a particularly large southward dispersal event.

We used both the transient and asymptotic growth rates
to characterize the annual population dynamics.
The transient growth rate quantified the dynamics as they actually occurred,
including fluctuations due to the non-equilibrium distribution of individuals across
population states (i.e., basin $\times$ stage-class combinations).
In contrast, the asymptotic growth rate assumed an equilibrium state-distribution
at each time point and thereby isolated the direct effects of the demographic rates.
Both the transient and asymptotic growth rates fluctuated substantially
across the study period,
indicating periods of rapid population growth and decline (Figure \ref{fig:lam}a).
Over the first two decades,
the asymptotic growth rate was cyclic with a period of approximately 6 years
(Figure \ref{fig:lam}b).
However, this was supplanted by fluctuations of lower-amplitude and higher-frequency
in the last 10 years (Figure \ref{fig:lam}a).
The 6-year periodicity was weaker for the transient growth rate,
which instead was dominated by two bouts of high-frequency fluctuations
at the beginning and end of the study period.
Together, these results indicate that there was a cyclic aspect to the large fluctuations
of the M\'{y}vatn stickleback population,
although the dynamics appear to have changed over the last decade.
Furthermore, transience due to non-equilibrium state distributions
largely obscured the cyclicity in the realized population dynamics.

We assessed the contributions of each demographic rate to the population dynamics
using elasticities,
which quantified the proportional change in the population growth rate in
response to proportional perturbations in demographic rates.
Elasticities are shown for the both the transient and asymptotic growth rates,
with the former including indirect effects of changes in demographic rates
via changing distributions across basin $\times$ stage-class combinations,
while the latter only included direct effects on the growth rate per se.
The differences between the transient and asymptotic growth rates primarily manifested
among years for a given demographic rate,
with the transient elasticities being more variable and changing less smoothly through time
than the asymptotic elasticities.
This indicates that there was a substantial transient component to the effect of a
given demographic rate at a particular point in time.
However, the asymptotic elasticities largely characterized the overall
effects of each demographic rate across the entire time series.
For both the transient and asymptotic growth rates,
elasticities were neutral or positive in most years for all demographic rates
except for dispersal probabilities from the North to the South Basin,
which were substantially negative in most years.
The negative elasticities for southward dispersal indicated that conditions were
demographically less favorable in the South Basin than in the North,
such that southward dispersal generally reduced the population growth rate.
Among the remaining demographic rates,
the largest elasticities were for juvenile survival, recruitment, and adult survival
in the North Basin, while the analogous rates for the South Basin were generally close to zero.
This pattern in especially pronounced in the most recent years,
coinciding with low survival (Figure \ref{fig:surv}a)
and adult abundance (Figure \ref{fig:data}b) in the South Basin.
Together, these results show that the North Basin dominated
the overall population dynamics,
and this dominance increased towards the end of the study period.





% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% Discussion
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------



\section*{Discussion}

We used a stage-structured metapopulation model with time-varying demographic rates
to characterize the dynamics of threespine stickleback
in the shallow and productive Lake M\'{y}vatn.
The population fluctuated substantially over the past three decades,
driven by temporal variation in recruitment, survival, and dispersal.
Recruitment was only modestly synchronized between the two basins,
whereas survival probabilities of adults were more-strongly synchronized,
contributing to cyclic fluctuations in the lake-wide population with a period
of approximately 6 years for much of the time series.
Moreover, the two basins were coupled through dispersal,
with the North Basin subsidizing the South Basin
and playing a dominant role in driving the lake-wide dynamics.
While the population dynamics were generally cyclic,
they appeared to shift in the final decade towards fluctuations
of lower amplitude and higher frequency.
This shift was associated with a sharp decline in lake-wide survival probabilities
and limited net dispersal.
In addition to their direct effects,
the time-varying demographic rates indirectly resulted in large transient fluctuations
in the population growth rate,
partially obscuring the cyclic nature of the underlying dynamics.
Overall, these results illustrate the relevance of both direct and transient effects
of temporal variation in recruitment, survival, and dispersal
for determining the dynamics of the stickleback metapopulation in M\'{y}vatn.

Our results show that the dynamics of the M\'{y}vatn stickleback population
were best explained by changes in the underlying demographic rates,
as opposed to arising directly from basic life-history characteristics
(e.g., average lifespan; average maturation rate)
as would be embodied by a model with fixed demographic rates \citep{caswell2001matrix}.
Indeed, in the absence of time-varying demographic rates,
the best-fitting model rapidly reached its equilibrium distribution
with essentially constant population density.
This finding is consistent with \cite{wootton2005},
who compared the dynamics of 3 threespine stickleback populations in the United Kingdom
(one riverine, one lacustrine, and one backwater)
and found that only the backwater population had cyclic fluctuations.
Such variation in the dynamics of different populations
is contrary to what one would expect if the cyclicity were
an inherent feature of threespine stickleback life-history.
However, the lack of transient fluctuations arising directly
from life history or demographic structure
does not imply that transience was not important for the population dynamics.
On the contrary,
there were large transient effects on the realized population growth rate.
These transient features arose because of repeated perturbations
of the demographic rates, which perpetually kept the population
away from its equilibrium state distribution.
While the dynamics of our model were locally linear and density-independent,
our approach for inferring time-varying demographic rates can implicitly embody
nonlinear and density-dependent dynamics \citep{ives2012}.
It is possible that the time-varying demographic rates themselves were the manifestation
of some transient phenomenon,
such as overcompensatory density-dependence that could lead to sustained cycles under
constant ``environmental'' conditions
\citep[e.g.,][]{may1974}.
This highlights the key point that transience must be defined with respect to some
set of conditions under which a system can be characterized as ``fixed''
\citep{hastings2010},
which is as much a feature of the observer as of the phenomenon being observed.

Uncovering the mechanistic basis for changes in the demographic rates
is crucial for understanding the ecological and evolutionary relevance
of population fluctuations.
Our metapopulation model for M\'{y}vatn stickleback implies that processes both lake-wide
and specific to each basin are likely to contribute.
For example, the broadly synchronized survival probabilities across the lake,
especially for adults, suggest a lake-wide driver.
While several possibilities exist,
a likely candidate is predation from salmonids such as Arctic charr and brown trout.
Arctic charr in particular are widely distributed and disperse extensively
throughout the lake (\citep[REF;][]{gudbergsson2004},
which could induce synchronous fluctuations in stickleback survival.
Avian predators may also be important drivers of temporal variation in survival,
although they tend to be more localized \citep{einarsson2004myvatn}
and therefore do not obviously account for similarities between the two basins.
Predation-induced synchrony among patches has been observed in other metapopulations
and may be quite common in cases where predators are highly mobile relative to their prey
\citep{ims2000, gilg2009}.
In contrast to survival,
per capita recruitment was largely asynchronous between the two basins,
implying that it was driven largely by factors unique to each.
The two basins differ substantially in their substrates, bathymetry and water chemistry
\citep{einarsson2004myvatn},
which in turn translates to differences
in invertebrate communities \citep{bartrons2015spatial}
that serve as key food sources for threespine stickleback \citep{gudmundsson1996}.
Food availability could influence adult fecundity or survival
of recently-hatched juveniles,
both of which would manifest as variation in per capita recruitment in our model.
Recruitment tends to be highly volatile in fish populations,
and while notoriously challenging,
identifying the ecological underpinnings of this volatility is essential
for characterizing the role
of temporal variation recruitment in fish population dynamics
\citep{dixon1999episodic, ludsin2014physical}.

In addition to the ecological perspective
of population demography and spatial heterogeneity,
our analyses also have implications for evolutionary processes over space and time.
Threespine stickleback provide some of the most prominent examples of adaptive divergence,
ecological speciation, and rapid evolution \citep[reviewed in][]{hendry2013stickleback}.
Indeed, some populations of stickleback
have undergone substantial intra-lacustrine diversification (e.g. REFS including Bolnick).
In M\'{y}vatn, the distribution of the threespine stickleback population across
two ecologically distinct basins with at least some differentiation in demographic rates,
especially recruitment, could set the stage for adaptive divergence.
Previous work from M\'{y}vatn has identified spatial variation
in feeding morphology and defensive traits \citep{millet2013}.
For example, dorsal spines tend to be longer in the South Basin than in the North Basin,
which might reflect elevated risk of predation from piscivorous birds in the south (REF).
However, population-genetic studies have provided mixed evidence
for genetic differentiation and clear evidence of extensive gene flow
across the lake \citep{olafsdottir2007postglacial, millet2013},
which is consistent with the inference from our metapopulation model that the two basins
are dynamically coupled through dispersal.
Nonetheless, if differences in natural selection between the basins are sufficiently strong,
it is plausible that this could result in phenotypic differentiation
even in the absence of clear population-genetic structure
\citep{rasanen2008disentangling}.
The apparent phenotypic variation between the two basins
could also be explained by phenotypic plasticity,
which theoretical work suggests may be favored in metapopulations
with strong coupling through dispersal \citep{sultan2002metapopulation}.
Moreover, the large temporal variation in survival and recruitment may set the stage
for fluctuating selection \citep{siepielski2009s},
which in turn could lead to rapid evolutionary changes in traits associated
with the underlying demographic rates.
Per capita population growth rates are tightly associated with evolutionary fitness,
and previous studies have successfully linked fluctuating population growth rates
to rapid evolutionary change in other populations
\citep{coulson2008dynamics, engen2014estimating, de2019stage}.

In summary, despite the long-standing interest in population fluctuations,
particularly those cyclic in character
\citep{elton1924, nicholson1935},
studies that decompose these dynamics into direct and transient contributions
from the underlying demographic rates are relatively rare
\citep{fox2000population, koons2017understanding, hoy2020fluctuations}.
By fitting a metapopulation model with time-varying demographic rates to
data on population densities of threespine stickleback in M\'{y}vatn,
we were able to decompose their population dynamics into their
underlying demographic drivers.
Our results show how population fluctuations can arise through the conjunction of
spatial coupling and synchronization of demographic rates,
and they highlight the potential importance
of accounting for transience in analyses of population dynamics.





% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------
% References,figures, etc.
% ---------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------

\bibliographystyle{ecology.bst}
\bibliography{refs.bib}

% ---------------------------------------------------------------------------------------
\clearpage
\begin{table}
\caption{\label{tab:compare}
.
}
\setlength{\tabcolsep}{12pt}
\begin{tabular}{lcc}
\toprule
Model                  &    Log-likelihood (posterior median) & LOOIC \\
\cmidrule{1-3}
full model             & -141 & 532 \\
adult dispersal        & -142 & 542 \\
no dispersal           & -223 & 654 \\
fixed rates            & -380 & 790 \\
\bottomrule
\end{tabular}
\end{table}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_data.pdf}
\caption{\label{fig:data}
(a) Distribution of trapping sites within M\'{y}van's
South (23, 27, 44, 44, and 135) and North Basins (DN, 124, and 124).
Gray areas indicate water and white areas indicate land.
(b) Scaled catch per unit effort (CPUE; scaled by mean) by station (points) and
posterior median scaled-CPUE from the full version of the metapopulation model (lines)
for each basin and stage class.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_fit.pdf}
\caption{\label{fig:fit}
Relative abundances (points) and fitted values from different versions
of the demographic model (lines).
We calculated relative abundances by scaling the density estimates from the
N-mixture model by the sampling area spanned by the traps within each basin.
Solid lines are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors (68\%).
Note that the fitted values for the full and adult-dispersal models
are visually indistinguishable.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_rec.pdf}
\caption{\label{fig:rec}
(a) Per capita recruitment as inferred from the adult-dispersal model.
Solid lines are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors (68\%).
(b) Covariance matrix for per capita recruitment by basin,
calculated from posterior medians.
The color shading corresponds to the magnitude of the covariance term,
which is also shown numerically.
The values were scaled by the mean for the entire matrix to emphasize
the relative magnitudes among the covariance terms.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_surv.pdf}
\caption{\label{fig:surv}
(a) Survival probabilities as inferred from the adult-dispersal model.
Solid lines are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors (68\%).
(b) Covariance matrix for survival probability by basin $\times$ stage combination,
calculated from posterior medians.
The color shading corresponds to the magnitude of the covariance term,
which is also shown numerically.
The values were scaled by the mean for the entire matrix to emphasize
the relative magnitudes among the covariance terms.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_disp.pdf}
\caption{\label{fig:disp}
Net dispersal of adults between basins as inferred from the adult-dispersal model.
We calculated net dispersal as the flux of individuals (in units of relative density)
from south to north (``northward'') minus the flux from north to south (``southward'').
The model was formulated such that dispersal was calculated after survival and stage-transitions,
which was reflected in the calculation of net dispersal.
Solid lines are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors.
Posterior summaries were applied to the calculation of net dispersal itself,
rather than net dispersal being calculated from posterior summaries.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_lam.pdf}
\caption{\label{fig:lam}
(a) Transient and asymptotic population growth rates,
projected annually from the adult-dispersal model.
Solid lines are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors (68\%).
The dashed horizontal line shows $\lambda=1$,
which corresponds to no change in the population size.
(b) Periodograms from wavelet transforms of transient and asymptotic growth rates,
with darker shading representing stronger signal associated with a given periodic element.
The black contour lines are based on signal quantiles and denote regions of high signal.
While the wavelet decomposition was conducted for periods up to the maximum period length
(29 years), the signal associated with periods >10 years was very weak.
So, for clarity the figure truncates the periodogram at 11 years.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------

% ---------------------------------------------------------------------------------------
\clearpage
\begin{figure}
\centering
\includegraphics{../analysis/figures/fig_elas.pdf}
\caption{\label{fig:elas}
Elasticity analysis of the transient and asymptotic population growth rates
with respect to the time-varying demographic rates.
Points are posterior medians,
and shaded regions are quantile-based uncertainty intervals
with coverage analogous to standard errors (68\%).
The black vertical lines show time-averages of the posterior medians
for each demographic parameter to aid visualization.
}
\end{figure}
\clearpage
% ---------------------------------------------------------------------------------------




% % ---------------------------------------------------------------------------------------
% % ---------------------------------------------------------------------------------------
% % Appendices
% % ---------------------------------------------------------------------------------------
% % ---------------------------------------------------------------------------------------
% 
% \renewcommand{\thefigure}{A\arabic{figure}}
% \renewcommand{\theequation}{A\arabic{equation}}
% \renewcommand{\thetable}{A\arabic{table}}
% \setcounter{equation}{0}
% \setcounter{figure}{0}
% \setcounter{table}{0}
% 
% 
% 
% % ---------------------------------------------------------------------------------------
% \section*{Appendix I: Transition rates} 
% % ---------------------------------------------------------------------------------------
% 
% We parameterized latent transition rate matrices for mortality ($\boldsymbol\Omega^{\mu}_t$), 
% stage-transition ($\boldsymbol\Omega^{\gamma}$), 
% and dispersal ($\boldsymbol\Omega^{\delta}_t$) as:
%  %
% % \begin{equation} \label{eq:Theta}
% % \begin{aligned}
% % \boldsymbol\Omega^{\mu}_t & = 
% % \left[
% % \begin{array}{cc|cc}
% %     -\omega^{\phi_{j,s}}_t & 0 & 0 & 0 \\
% %     0 & -\omega^{\phi_{a,s}}_t & 0 & 0 \\
% %     \hline
% %     0 & 0 & -\omega^{\phi_{j,n}}_t & 0 \\
% %     0 & 0 & 0 & -\omega^{\phi_{a,n}}_t \\
% %     \end{array}
% % \right] \\
% % \boldsymbol\Omega^{\gamma} & = 
% % \left[
% % \begin{array}{cc|cc}
% %     -\omega^{\gamma_{j}} & 0 & 0 & 0 \\
% %     \omega^{\gamma_{j}}  & 0 & 0 & 0 \\
% %     \hline
% %     0 & 0 & -\omega^{\gamma_{j}} & 0 \\
% %     0 & 0 & \omega^{\gamma_{j}}  & 0 \\
% %     \end{array}
% % \right] \\
% % \boldsymbol\Omega^{\delta}_t & = 
% % \left[
% % \begin{array}{cc|cc}
% %     -\omega^{\delta_{j,s}}_t & 0 & \omega^{\delta_{j,n}}_t & 0 \\
% %     0 & -\omega^{\delta_{a,s}}_t & 0 & \omega^{\delta_{a,n}}_t \\
% %     \hline
% %     \omega^{\delta_{j,s}}_t & 0 & -\omega^{\delta_{j,n}}_t & 0 \\
% %     0 & \omega^{\delta_{a,s}}_t & 0 & -\omega^{\delta_{a,n}}_t \\
% %     \end{array}
% % \right]
% % \end{aligned}
% % \end{equation}
% %
% Note that mortality implicitly entails transition to a ``death state'' that is omitted 
% for succinctness, as dead individuals do not contribute to future transitions.
% For each transition matrix $\boldsymbol\Omega^{\alpha}_t$, 
% we then calculated the probability of transitioning as
% %
% % \begin{equation} \label{eq:Psi}
% % \boldsymbol\Psi^{\alpha}_t = e^{\boldsymbol\Omega^{\alpha}_t}
% % \end{equation}
% %
% which is the solution to the differential equation associated with the Markov process
% specified by $\boldsymbol\Omega^{\alpha}_t$ 
% with initial condition equal to the 4 $\times$ 4 identity matrix.
% The unequal projection interval duration from June-August and August-June was handled 
% implicitly by the time-varying rates, 
% which proved more computationally stable than explicitly accounting for the projection
% interval duration in equation \ref{eq:Psi}.
% 
% The transition probability matrix was calculated as 
%  %
% % \begin{equation} \label{eq:POmega}
% % \mathbf{P}_{t} = \boldsymbol\Psi^{\delta}_t~\boldsymbol\Psi^{\gamma}~\boldsymbol\Psi^{\mu}_t.
% % \end{equation}
% %
% The order of multiplication implies that proportional survival is calculated first,
% followed by stage-transitions, and finally dispersal,
% resulting in the configuration of transition probabilities
% given in equations \ref{eq:W} and \ref{eq:B}.
% In principle, we could have included all of the demographic transitions in a single
% transition matrix,
% which would imply that all of the transition processes occurred simultaneously. 
% However, modeling the different transition processes sequentially facilitated interpretation
% of the resulting transition probabilities 
% (i.e., the matrix elements equations \ref{eq:W} and \ref{eq:B}), 
% as they would only pertain to a single type of demographic transition
% rather than multiple transition processes occurring simultaneously.
% This also facilitated convergence of the MCMC algorithm during model fitting, 
% for much the same reasons.
% 
% 
% 
% 
% % ---------------------------------------------------------------------------------------
% \section*{Appendix II: Sensitivity analysis} 
% % ---------------------------------------------------------------------------------------
% 
% We used the method of \cite{caswell2007sensitivity} to calculate the elasticities 
% (proportional sensitivities) of the annual transient population growth rate $\lambda_y$
% with respect to perturbations in the seasonal demographic rates.
% It was convenient to perform the calculations using the logarithm of $\lambda_y$,
% commonly denoted $r_y$.
% This parameter is related to total population size $N_y$ by the expression
% %
% % \begin{equation} \label{eq:r}
% % r_y = \text{log}\left(N_{y+1}\right) - \text{log}\left({N_y}\right).
% % \end{equation}
% %
% Note that
% %
% % \begin{equation} \label{eq:lsens}
% % \frac{\text{d}\lambda_y}{\text{d}\theta} = \lambda \frac{\text{d}r_y}{\text{d}\theta}
% % \end{equation}
% %
% where $\frac{\text{d}\lambda_y}{\text{d}\theta}$ can generically be interpreted
% as the sensitivity of $\lambda$ with respect to perturbations 
% in a single parameter $\theta$.
% The elasticity of $\lambda$ is then defined as
% %
% % \begin{equation} \label{eq:lelas}
% % \frac{\theta}{\lambda_y} \frac{\text{d}\lambda_y}{\text{d}\theta} = 
% %         \theta\frac{\text{d}r_y}{\text{d}\theta}.
% % \end{equation}
% %
% The multiplication of $\frac{\text{d}r_y}{\text{d}\theta}$ by $\theta$  
% implies proportional perturbations in $\theta$.
% Therefore, the sensitivity of $r_y$ with respect to proportional perturbations in $\theta$
% equals the elasticity of $\lambda_y$.
% This deduction is essentially a restatement of logarithmic relationship of $\lambda_y$
% and $r_y$, along with the properties of logarithmic derivatives.
% 
% The transient sensitivity of $r_y$ with respect to perturbations in demographic parameters
% is defined as
% %
% % \begin{equation} \label{eq:dr}
% % \frac{\text{d}r_y}{\text{d}\boldsymbol\theta_y^\top} = 
% %     \frac{\mathbf{c}^\top}{N_{y+1}} \frac{\text{d}\mathbf{x}_{y+1}}
% %             {\text{d}\boldsymbol\theta_{y+1}^\top}-
% %         \frac{\mathbf{c}^\top}{N_{y}} \frac{\text{d}\mathbf{x}_y}
% %             {\text{d}\boldsymbol\theta_y^\top}
% % \end{equation}
% %
% where $\boldsymbol\theta_y$ is a vector of demographic parameters, 
% $\mathbf{x}_y$ is a 4 $\times$ 1 vector of abundances in each state,
% $\mathbf{c}$ is a 4 $\times$ 1 vector of ones,
% and ``$\text{d}$'' is the derivative operator.
% We were interested in the sensitivity of $r_y$ with respect to proportional 
% perturbations in the seasonal demographic rates,
% which are connected to $\mathbf{x}_y$ through the annual population projection matrix
% $\mathbf{A}_y$ as defined in equation \ref{eq:A}.
% If $\boldsymbol\theta_y$ contains the seasonal demographic rates 
% (i.e., the collective elements of $\mathbf{P}_{t[y]}$ and $\mathbf{P}_{t[y]+1}$)
% and $\boldsymbol\epsilon_y$ is a vector of proportional perturbations in
% $\boldsymbol\theta_y$,
% then 
% %
% % \begin{equation} \label{eq:dx}
% % \frac{\text{d}\mathbf{x}_{y+1}}{\text{d}\boldsymbol\theta_{y+1}^\top} = 
% %     \mathbf{A}_y \frac{\text{d}\mathbf{x}_{y}}{\text{d}\boldsymbol\theta_y^\top}+
% %         \left(\mathbf{x}_{y}^\top \otimes \mathbf{I}_c \right)
% %             \frac{\text{dvec}\mathbf{A}_y}{\text{d}\boldsymbol\epsilon_y^\top}
% %                 \text{diag}\boldsymbol\epsilon_y
% % \end{equation}
% %
% where $\mathbf{I}_c$ is the $c \times c$ identity matrix with $c$ as the length
% of the parameter vector $\theta_y$,
% ``$\text{vec}$'' is an operator that creates a vector by stacking columns of the operand matrix,
% and ``$\text{diag}$'' is an operator that creates a square matrix with the operand vector on
% the diagonal and zeros elsewhere. 
% Defining an initial population size distribution $\mathbf{x}_0$ 
% that is independent of the demographic parameters implies that 
% $\frac{\text{d}\mathbf{x}_0}{\text{d}\boldsymbol\theta_0^\top} = \mathbf{0}$.
% Using this initial condition,
% the sensitivities can then be calculated by iterating equations \ref{eq:dr} and \ref{eq:dx}
% for each year, with perturbations $\boldsymbol\epsilon_y$ proportional (or equal)
% to the parameter vector $\boldsymbol\theta_y$.
% Asymptotic results can be obtained by iterating \ref{eq:dx} many times for a given year,
% which eliminates the dependence on the initial values such that each year can be treated
% independently. 




\end{document}

